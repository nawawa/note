ポートフォリオを作ってる最中の筆者目線の話です。

バックエンドフレームワークを完全にJson入出力窓口にした場合、フレームワーク内部で持ってるindex.html上でSPAを構築するか、フレームワークとはベつに本番環境を用意してSPAをホスティングするか、ちょっと悩みます。

セルフブレスト的に書きながら検討しようと思います。（Vue.jsないしNuxtで作る前提です）

## TL;DR

- 基本的にはサーバーサイドのCI/CDに学習コストを割きたいので、フロントの開発・運用は楽をしたい
- 継続的運用を視野に入れてるので、インフラコストをあまりかけたくない
- 将来的にはReact・Next.jsをVersekへホスティングする構成へ移行したいので、Laravelとはあまり癒着させたくない + IFFE周りの学習コストを抑えたい
- 以上の理由から、NetlifyへNuxtアプリケーションをホスティングすることにした

## Nuxtで作るメリット

具体的な実装部分は、Vueで作ろうがNuxtで作ろうがほとんど変わらないと思います。
それを踏まえた上でNuxtで構築する明確なメリットがあるとしたら、やはり超簡単にSSR・SSGを導入できることでしょう。

問題はそれらが必要か？ということです。

ある程度のユーザー数がある、ないしページ数が数十ページに及ぶようなSPAの場合、仕様上どうしても初期ロードに時間がかかるSPAの場合は、パフォーマンスに難が生じる可能性が高いです。

他にも、生成されるDOMの構造がGoogleのクローラーが見た時点ではわからないのでSEOに弱い、というデメリットもあったようですが、今はクローラーが賢くなってるのでその問題は解消したという話もあります。とはいえ、いずれにせよ最初のレンダリングに時間がかかることには変わりがないので、ほとんどの場合では、パフォーマンスの観点からブラウザ外でレンダリングした方がいいと考えてよさそうです。少なくともSaaSを構築するという場合は。

もしこれが一社でのみ使われる業務用システム等であれば、Vueか、もっと小規模なAlpine.jsか何かでミニマムなSPAを作るくらいがむしろちょうどいいかもしれません。

なので、一番のメリットは「パフォーマンスを良くしやすい」ということに尽きます。

## Nuxtで作るデメリット

SSRするにせよ、Nuxtアプリケーションをホスティングする環境が必要です。だるいです。
何かしらのインフラを自前で構築しないといけないというのも、セキュリティリスクを抱えることに繋がるためデメリットですし、それ以上にデプロイ先の選択肢がありすぎるのもだるいです。「LaravelといっしょにVueで作っちゃおうかな」という方向へ心が揺らいでいるのはこれが理由です。

注意すべきなのは、同じ「Nuxtアプリケーションのデプロイ」という要件であったとしても、SPAそのものかSSGが生成したdistディレクトリを静的にホストするのか、リクエストを受けたらCloudFunctionなりLamdaなりでサーバーレスなSSRを行わせるのか、あるいはEC2やECSのようなマジサーバーでSSRするのかで、候補に入るサービス・入らないサービスが異なってくることです。

SSRをやらないならそもそもNuxtで作る意味が薄くなってくるので、基本的にはSSRする前提で考えることにはなると思うのですが、そうなるとサーバーを契約して運用コストを支払うか、あるいはサーバーレスにNode.jsを実行するようなGCPやAWSの各種サービスの学習コストを支払うことになるかの、いずれかになります。

AWSを使うならAWSのこんなサービスと連携できるところが良いとか、Firebaseを使うならこんな機能を使えるところが良いとか、IaaSごとのメリデメというのもまた異なってくるわけで、それぞれのサービスに対しての知見があまりない以上、そういった観点からは選び切れる気がしません。

これが、使用するフレームワークがNext.jsだったとしたら「Versel一択っしょ」と考えられる分まだ楽なので、そもそもVue・Nuxtという選定自体もはやベターとは言い難いのが現状なのです。つらいですね。

## Laravel in Vue.jsで作るメリット

「スピードが出る」これに尽きます。

一番初心者に優しいフロントエンド開発といえば、RailsのerbやLaravelのBladeのような、内蔵されているテンプレートエンジンを使ってレンダリングする手法です。やってることはWordPressとまんまいっしょですね。

そうした内蔵SPAであれば、テンプレートエンジンを使った開発とほとんど同じ感覚で作れるような気がします。実際にハンズオン的にLaravel ＋ Vue.jsでTODOアプリを作ってみた際には、かなり作りやすさを感じました。

また、Laravelと同じインフラ環境を共有できるので、運用コストも低めに抑えられると考えられます。

## Laravel in Vue.jsで作るデメリット

パフォーマンスに期待できないことと、インフラコストがかさみそうなことの2点が大きいかなと思います。

正直、レンダリングをさせずにJson入出力装置として稼働させるだけなら、HerokuにLaravelをデプロイし、GASで書いたスクリプトを使ってHerokuのインスタンスを定期的に起こすようなことをしていれば、まだ実用には堪える気がするのです。それができれば、少なくともバックエンドのインフラコストに関してはまあまあケチれる。

ただSPAを内蔵させるとなると、これはもうEC2レベルのサーバーを使わないとまともに動かせないのではないのかな…。そうなるとｵｶﾈﾁｬﾝとセキュリティが…

## 今後の学習ロードマップを踏まえて考えるのもいいのかもしれない

「知らんがな」と思われるでしょうけど、前提として、筆者は個人開発をめちゃめちゃやりたい人間です。

ガシガシ個人開発やりてーな！と考えてしまうと、そもそもNuxtをやりこむことにあまりメリットがないのです。Reactの方がいいので。
ただ、今はまだ初心者なうえ求職者だし、個人開発したプロダクトをスタートさせることよりは、さっさとポートフォリオを作り切って就職することの方が優先されるべきフェーズなので、Reactを学習するよりはVueでサクッと作り切ることを優先するべきなのです。

なのでVueかNuxtで作るということは揺らがないのですが、結局のところもっともベターと考えられる選択肢は「Netlifyにホスティングする前提でNuxtアプリケーションを作る」というあたりかな、というのが今回の結論です。

Netlifyは日本のCDNがないので速度が出ないという話もありますが、それを差し置いても、GitHubのmainブランチへプッシュするだけで自動ビルド・デプロイを行なってくれ、SSR・SSGどちらにしても同じ流れで運用できるというところが魅力的です。なにせ無料ですし。
基本的にSaaSの実運用目的で使用されている例はそんなにないかな？という印象でして、ありがちな使用例としては、JAMstacアーキテクチャを採用しているブログやWebサイトのホスティング先として、SSGとしてNuxtを運用しているケースがもっとも多いかなと思います。

なのでNetlifyの使用経験がWeb開発の現場で活きるかといわれればかなり微妙ですが、少なくとも個人で何らかのサイトを運営するためのプラットフォームとしてはかなり優れていますし、サーバーサイドのCI/CDへ集中的に学習コストを割きたいことを考えると、フロントエンドの効率的な開発・運用の面でNetlifyの機能に頼り切れることも、恩恵が大きいと考えられます。

---

## いろいろ参考リンク

各レンダリング形式の比較：https://nishimura.club/nuxt-spa-ssr-ssg

AWS LambdaでExpressを動かし、そのミドルウェアとしてNuxt.jsを稼働させる手法：https://mya-ake.com/posts/nuxtjs-on-aws-lambda/

FirebaseにSSRモードでデプロイする手順：https://zenn.dev/sengosha/articles/de4c3bb6ffbe3be2b3c2

Nuxt.jsを採用したnoteの事例：https://www.youtube.com/watch?v=yDaZFK5jbo8&list=FLVpGw83_TR2s8P3kiEqmnkA&index=32
（とはいえこれは過去の話で、現在はnoteでもNext.jsへガンガン移行しています。初心者の入り口としてはとても参考になる）

